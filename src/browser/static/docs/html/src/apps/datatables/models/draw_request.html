<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&lt;no title&gt; &mdash; DH_Doc 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="DH_Doc 0.1 documentation" href="../../../../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">DH_Doc 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
    <h1> Generated by Sphinx </h1>
    
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p>from django.http import HttpRequest
from draw_request_column import DrawRequestColumn
from draw_request_order import DrawRequestOrder
from draw_request_column_filter import DrawRequestColumnFilter</p>
<p>&#8216;&#8217;&#8217;
Class for parsing draw request from DataTables.js and converting into a SQL query.
Refer to <a class="reference external" href="http://www.datatables.net/manual/server-side">http://www.datatables.net/manual/server-side</a> for more information about how this request
is constructed.
&#8216;&#8217;&#8217;
class DrawRequest:</p>
<blockquote>
<div><p>&#8216;&#8217;&#8217;
Create the instance using a django.http.HttpRequest object.
The request must have all the parameters specified in <a class="reference external" href="http://www.datatables.net/manual/server-side">http://www.datatables.net/manual/server-side</a>
in the GET parameters. Otherwise, the initializer will throw an exception.
&#8216;&#8217;&#8217;
def __init__(self, request):</p>
<blockquote>
<div><p># First extract the easy variables.
self.draw = int(request.GET[&#8220;draw&#8221;])
self.start = int(request.GET[&#8220;start&#8221;])
self.length = int(request.GET[&#8220;length&#8221;])
self.searchValue = request.GET[&#8220;search[value]&#8221;]
self.searchRegex = self.to_bool(request.GET[&#8220;search[regex]&#8221;])
if &#8220;filterInverted&#8221; in request.GET:</p>
<blockquote>
<div>self.filterInverted = self.to_bool(request.GET[&#8220;filterInverted&#8221;])</div></blockquote>
<p># Next, we&#8217;ll extract the filters.
self.filters = []
hasMoreFilters = True
filterIndex = 0
while hasMoreFilters:</p>
<blockquote>
<div><p>columnIndex = 0
hasMoreColumns = True
while hasMoreColumns:</p>
<blockquote>
<div><p>filter_op_fmt = &#8220;filters[%s][%s][filter_op]&#8221; % (filterIndex, columnIndex)
filter_text_fmt = &#8220;filters[%s][%s][filter_text]&#8221; % (filterIndex, columnIndex)
filter_colname_fmt = &#8220;filters[%s][%s][colname]&#8221; % (filterIndex, columnIndex)
if filter_op_fmt in request.GET:</p>
<blockquote>
<div><dl class="docutils">
<dt>if len(self.filters) &lt;= filterIndex:</dt>
<dd>self.filters.append([])</dd>
</dl>
<p>filter_op = request.GET[filter_op_fmt]
filter_text = request.GET[filter_text_fmt]
filter_colname = request.GET[filter_colname_fmt]
column_filter = DrawRequestColumnFilter(filter_colname, filter_text, filter_op)
self.filters[filterIndex].append(column_filter)
columnIndex += 1</p>
</div></blockquote>
<dl class="docutils">
<dt>elif columnIndex != 0:</dt>
<dd>hasMoreColumns = False
filterIndex += 1</dd>
<dt>else:</dt>
<dd>hasMoreColumns = False
hasMoreFilters = False</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p># Next, we&#8217;ll extract the columns and order.
# We don&#8217;t know how many of them there are, so we&#8217;ll have to
# loop through until we hit the end.
self.columns = []
self.order = []
moreCols = True
moreOrds = True
i = 0
while moreOrds or moreCols:</p>
<blockquote>
<div><p># Extract the order, if there is one.
order_column_fmt = &#8220;order[%d][column]&#8221; % (i,)
order_dir_fmt = &#8220;order[%d][dir]&#8221; % (i,)
if order_column_fmt in request.GET:</p>
<blockquote>
<div>order_column = int(request.GET[order_column_fmt])
order_dir = request.GET[order_dir_fmt]
self.order.append(DrawRequestOrder(order_column, order_dir))</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>moreOrds = False</dd>
</dl>
<p># Extract the column, if there is one.
column_data_fmt = &#8220;columns[%d][data]&#8221; % (i,)
column_name_fmt = &#8220;columns[%d][name]&#8221; % (i,)
column_searchable_fmt = &#8220;columns[%d][searchable]&#8221; % (i,)
column_orderable_fmt = &#8220;columns[%d][orderable]&#8221; % (i,)
column_search_value_fmt = &#8220;columns[%d][search][value]&#8221; % (i,)
column_search_regex_fmt = &#8220;columns[%d][search][regex]&#8221; % (i,)
if column_data_fmt in request.GET:</p>
<blockquote>
<div>column_data = request.GET[column_data_fmt]
column_name = request.GET[column_name_fmt]
column_searchable = self.to_bool(request.GET[column_searchable_fmt])
column_orderable = self.to_bool(request.GET[column_orderable_fmt])
column_search_value = request.GET[column_search_value_fmt]
column_search_regex = self.to_bool(request.GET[column_search_regex_fmt])
self.columns.append(DrawRequestColumn(column_data, column_name, column_searchable, column_orderable, column_search_value, column_search_regex))</div></blockquote>
<dl class="docutils">
<dt>else:</dt>
<dd>moreCols = False</dd>
</dl>
<p># Move on to the next element.
i += 1</p>
</div></blockquote>
</div></blockquote>
<dl class="docutils">
<dt>def to_bool(self, val):</dt>
<dd>return val == &#8220;true&#8221;</dd>
<dt>def __repr__(self):</dt>
<dd>return &#8220;DrawRequest(draw=%s, start=%s, length=%s, searchValue=%s, searchRegex=%s, columns=%s, filters=%s, order=%s)&#8221; % (self.draw, self.start, self.length, self.searchValue, self.searchRegex, self.columns, self.filters, self.order)</dd>
</dl>
<p>__str__ = __repr__</p>
</div></blockquote>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/src/apps/datatables/models/draw_request.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, MIT Living Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
      |
      <a href="../../../../_sources/src/apps/datatables/models/draw_request.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>